# =====================================
# Loon å®šåˆ¶é«˜å¯ç”¨é…ç½® - ä½œè€…ï¼šGemini AI
# æ ¸å¿ƒæ¡†æ¶ï¼šiKeLee é«˜å¯ç”¨ + è§„åˆ™ä¼˜å…ˆçº§ä¼˜åŒ– + å…¨åŠŸèƒ½é›†æˆ
# å®šåˆ¶éœ€æ±‚ï¼šApp ç²¾å‡†åˆ†æµ (PROCESS-NAME) + è‹±å›½/éŸ©å›½ç­–ç•¥ç»„ + å…¨åŠŸèƒ½å»å¹¿å‘Š
# =====================================

[General]
ip-mode=v4-only
ipv6-vif=off
dns-server=system
sni-sniffing=true
disable-stun=true
dns-reject-mode=LoopbackIP
domain-reject-mode=DNS
udp-fallback-mode=REJECT
wifi-access-http-port=7222
wifi-access-socks5-port=7221
allow-wifi-access=false
interface-mode=auto
test-timeout=5
disconnect-on-policy-change=false
internet-test-url=http://connectivitycheck.platform.hicloud.com/generate_204
proxy-test-url=http://www.gstatic.com/generate_204
# resource-parser ä¿æŒé»˜è®¤æˆ–ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬
# resource-parser=https://raw.githubusercontent.com/sub-store-org/Sub-Store/release/sub-store-parser.loon.min.js
geoip-url=https://geodata.kelee.one/Country-Masaiki.mmdb
ipasn-url=https://geodata.kelee.one/GeoLite2-ASN-P3TERX.mmdb
skip-proxy=192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, localhost, *.local, e.crashlynatics.com
bypass-tun=10.0.0.0/8, 100.64.0.0/10, 127.0.0.0/8, 169.254.0.0/16, 172.16.0.0/12, 192.0.0.0/24, 192.0.2.0/24, 192.88.99.0/24, 192.168.0.0/16, 198.51.100.0/24, 203.0.113.0/24, 224.0.0.0/4, 255.255.255.255/32


[Proxy]

# =====================================
# ğŸŸ¢ èŠ‚ç‚¹è®¢é˜… [Remote Proxy] ğŸŸ¢
# è¯·åœ¨æ­¤å¤„æ›¿æ¢ä¸ºæ‚¨è‡ªå·±çš„è®¢é˜…é“¾æ¥ï¼
# =====================================
[Remote Proxy]
# è®¢é˜…1 = æ‚¨çš„è®¢é˜…é“¾æ¥, udp=true, fast-open=true, vmess-aead=true, enabled=true


# =====================================
# ğŸŸ¢ èŠ‚ç‚¹ç­›é€‰ [Remote Filter] ğŸŸ¢
# ç¡®ä¿èŠ‚ç‚¹åç§°åŒ…å«ä»¥ä¸‹å…³é”®è¯
# =====================================
[Remote Filter]
# éŸ©å›½èŠ‚ç‚¹
KR_Filter = NameRegex, FilterKey="^(?=.*((?i)ğŸ‡°ğŸ‡·|éŸ©å›½|éŸ“|é¦–å°”|(\b(KR|KOR|Korea)(\d+)?\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$"
# æ—¥æœ¬èŠ‚ç‚¹
JP_Filter = NameRegex, FilterKey="^(?=.*((?i)ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|(\b(JP|JPN|Japan)(\d+)?\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$"
# æ–°åŠ å¡èŠ‚ç‚¹
SG_Filter = NameRegex, FilterKey="^(?=.*((?i)ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®|(\b(SG|SGP|Singapore)(\d+)?\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$"
# è‹±å›½èŠ‚ç‚¹ (å®šåˆ¶æ·»åŠ )
UK_Filter = NameRegex, FilterKey = "(?i)(ğŸ‡¬ğŸ‡§|è‹±å›½|UK)" 
# ... [å…¶ä»–ä¸éœ€è¦ä½†ä¿ç•™çš„ç­›é€‰å™¨è¯·è‡ªè¡Œæ·»åŠ ] ... 


# =====================================
# ğŸŸ¢ ç­–ç•¥ç»„ [Proxy Group] ğŸŸ¢
# æ ¸å¿ƒï¼šurl-test è‡ªåŠ¨ä¼˜é€‰ + fallback è‡ªåŠ¨å…œåº•
# =====================================
[Proxy Group]
# æœ€ç»ˆé«˜å¯ç”¨å…œåº•ç­–ç•¥ï¼šå¦‚æœæ‰€æœ‰ä¼˜é€‰ç»„éƒ½å¤±æ•ˆï¼Œåˆ™æŒ‰é¡ºåºåˆ‡æ¢ï¼Œä¿è¯ä¸å¤±è”ã€‚
å…œåº•åå¤‡ç­–ç•¥ = fallback, KR_Auto, JP_Auto, SG_Auto, UK_Auto, DIRECT, interval=60, max-timeout=2000, img-url=https://github.com/shindgewongxj/WHATSINStash/raw/main/icon/fallback.png

# å„åœ°åŒºè‡ªåŠ¨ä¼˜é€‰ç­–ç•¥ç»„ (url-test)
KR_Auto = url-test, KR_Filter, interval=60, tolerance=50, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/KR.png
JP_Auto = url-test, JP_Filter, interval=60, tolerance=50, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/JP.png
SG_Auto = url-test, SG_Filter, interval=60, tolerance=50, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/SG.png
UK_Auto = url-test, UK_Filter, interval=60, tolerance=50, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/UK.png

# ç‰¹æ®Šç”¨é€”ç­–ç•¥ç»„ (AI ä¼˜é€‰è‹±å›½èŠ‚ç‚¹)
AI_Auto = url-test, UK_Filter, interval=60, tolerance=50, img-url=https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App-Icon/ChatGPT.png

# å›½å†…ç›´è¿ç­–ç•¥ç»„ (ç”¨äºè¿œç¨‹è§„åˆ™çš„ policy)
å¤§é™†ç½‘å€ = select, DIRECT, KR_Auto, JP_Auto, SG_Auto, UK_Auto # å›½å†…æµé‡é»˜è®¤ DIRECTï¼Œä½†æä¾›ä»£ç†é€‰é¡¹


# =====================================
# ğŸŸ¢ è§„åˆ™ [Rule] ğŸŸ¢
# ä¼˜å…ˆçº§ï¼šApp > æœ¬åœ°æ‹¦æˆª > è¿œç¨‹è§„åˆ™ > FINAL
# =====================================
[Rule]
# === P1. æœ¬åœ°æœ€é«˜ä¼˜å…ˆçº§ App åˆ†æµ (PROCESS-NAME) ===
PROCESS-NAME,Spotify.app,KR_Auto           # éŸ©å›½ä¼˜é€‰
PROCESS-NAME,YouTube.app,SG_Auto           # æ–°åŠ å¡ä¼˜é€‰
PROCESS-NAME,Reddit.app,JP_Auto            # æ—¥æœ¬ä¼˜é€‰
PROCESS-NAME,Telegram.app,KR_Auto          # éŸ©å›½ä¼˜é€‰
PROCESS-NAME,Instagram.app,JP_Auto         # æ—¥æœ¬ä¼˜é€‰
PROCESS-NAME,X.app,SG_Auto                 # æ–°åŠ å¡ä¼˜é€‰
PROCESS-NAME,ChatGPT.app,AI_Auto           # è‹±å›½ä¼˜é€‰

# === P2. æœ¬åœ°æ‹¦æˆªè§„åˆ™ ===
URL-REGEX,\.log\.,REJECT
DOMAIN-SUFFIX,app-measurement.com,REJECT   # é˜»æ­¢ Google Analytics è¿½è¸ª

# === P7. æœ€ç»ˆå…œåº•è§„åˆ™ ===
FINAL, å…œåº•åå¤‡ç­–ç•¥


# =====================================
# ğŸŸ¢ è¿œç¨‹è§„åˆ™ [Remote Rule] ğŸŸ¢
# é¡ºåºï¼šå±€åŸŸç½‘ -> å¹¿å‘Š -> å›½å†…åˆ†æµ -> æµ·å¤– App
# =====================================
[Remote Rule]
# P3. å±€åŸŸç½‘ç›´è¿
https://kelee.one/Tool/Loon/Lsr/LAN_SPLITTER.lsr, policy=DIRECT, tag=LAN, enabled=true

# P4. è¿œç¨‹å¹¿å‘Šæ‹¦æˆª
https://github.com/fmz200/wool_scripts/raw/main/Loon/rule/rejectAd.list, policy=REJECT, tag=å¹¿å‘Šæ‹¦æˆªåˆé›†-è§„åˆ™@å¥¶æ€, enabled=true

# P5. å›½å†…åˆ†æµ (CN REGION/GeoIP)
https://kelee.one/Tool/Loon/Lsr/REGION_SPLITTER.lsr, policy=DIRECT, tag=CN REGION, enabled=true

# P6. å¸¸è§„æµ·å¤– App åŸŸååˆ†æµ (é¿å…é—æ¼ï¼ŒæŒ‡å‘é«˜å¯ç”¨ç­–ç•¥)
https://rule.kelee.one/Loon/Global.lsr, policy=å…œåº•åå¤‡ç­–ç•¥, tag=Global, enabled=true

# é’ˆå¯¹ç‰¹å®šAppçš„åŸŸååˆ†æµï¼Œç¡®ä¿policyæŒ‡å‘æ­£ç¡®çš„ä¼˜é€‰ç»„æˆ–å…œåº•ç­–ç•¥
https://github.com/blackmatrix7/ios_rule_script/raw/master/rule/Loon/TikTok/TikTok.list, policy=SG_Auto, tag=TikTok_Domain, enabled=true
https://github.com/blackmatrix7/ios_rule_script/raw/master/rule/Loon/Google/Google.list, policy=å…œåº•åå¤‡ç­–ç•¥, tag=Google_Domain, enabled=true


[Host]
# æ”¹å–„App Storeä¸‹è½½é€Ÿåº¦
iosapps.itunes.apple.com = iosapps.itunes.apple.com.download.ks-cdn.com


[Rewrite]

[Script]

[Remote Script]
https://github.com/fmz200/wool_scripts/raw/main/Loon/script/tasks.scripts, tag=å®šæ—¶ä»»åŠ¡åˆé›†@fmz200, enabled=true
https://github.com/fmz200/wool_scripts/raw/main/Loon/script/tools.scripts, tag=è„šæœ¬å·¥å…·åˆé›†@fmz200, enabled=true


# =====================================
# ğŸŸ¢ æ’ä»¶ [Plugin] - ä¸°å¯Œçš„åŠŸèƒ½ä¸è§£é” ğŸŸ¢
# =====================================
[Plugin]
# === è„šæœ¬ç®¡ç†å·¥å…·ï¼ˆåŸºç¡€æ¶æ„ï¼‰===
https://raw.githubusercontent.com/chavyleung/scripts/master/box/rewrite/boxjs.rewrite.loon.plugin, policy=å…œåº•åå¤‡ç­–ç•¥, enabled=true
https://raw.githubusercontent.com/sub-store-org/Sub-Store/master/config/Loon.plugin, policy=å…œåº•åå¤‡ç­–ç•¥, enabled=true
https://raw.githubusercontent.com/Script-Hub-Org/Script-Hub/main/modules/script-hub.loon.plugin, policy=å…œåº•åå¤‡ç­–ç•¥, enabled=true

# === å»å¹¿å‘Šä¸è§£é”æ’ä»¶ ===
https://raw.githubusercontent.com/fmz200/wool_scripts/raw/main/Loon/plugin/blockAds.plugin, policy=DIRECT, enabled=true
https://raw.githubusercontent.com/fmz200/wool_scripts/raw/main/Loon/plugin/WeChatMiniAds.plugin, policy=DIRECT, enabled=true
https://raw.githubusercontent.com/fmz200/wool_scripts/raw/main/Loon/plugin/weibo.plugin, policy=DIRECT, enabled=true
https://raw.githubusercontent.com/001ProMax/Surge/main/Loon/Spotify.plugin, policy=KR_Auto, img-url=https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/apps/spotify.png, enabled=true
https://gitlab.com/lodepuly/vpn_tool/raw/master/Loon/YouTube.plugin, policy=SG_Auto, enabled=true
https://gitlab.com/lodepuly/vpn_tool/raw/master/Loon/Bilibili.plugin, policy=DIRECT, enabled=true
https://raw.githubusercontent.com/fmz200/wool_scripts/raw/main/Loon/plugin/AppStore.plugin, policy=DIRECT, enabled=true

# === ç³»ç»Ÿä¸è¾…åŠ©å·¥å…· ===
https://raw.githubusercontent.com/fmz200/wool_scripts/raw/main/Loon/plugin/cookies.plugin, policy=DIRECT, enabled=false
https://raw.githubusercontent.com/fmz200/wool_scripts/raw/main/Loon/plugin/Auto_Join_TF.plugin, policy=å…œåº•åå¤‡ç­–ç•¥, enabled=false
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/refs/heads/master/Plugin/skip-proxy.lpx, policy=DIRECT, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Alpha/Imm.png, enabled=true
https://raw.githubusercontent.com/VirgilClyne/GetSomeFries/main/plugin/HTTPDNS.Block.plugin, policy=DIRECT, enabled=true


[Remote Rewrite]

[Mitm]
hostname = -www.google.com
ca-p12 = 
ca-passphrase = 
skip-server-cert-verify = false
